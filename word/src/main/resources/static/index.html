<!DOCTYPE html>
<html>
<head> 
    <meta charset="utf-8"> 
    <title>菜鸟教程(runoob.com)</title> 
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
</head>
<body>
<div id="word"></div>
<audio src="https://www.w3school.com.cn/i/song.mp3" controls id="audio">low browsers not support</audio>

<span id="bf" onclick="bf();">播放/暂停</span>

<span id="bbf" onclick="bbf('banana');">换图</span>
<!--

<iframe id="idSign" src="https://cn.bing.com/images/async?q=apple&first=43&count=35&relp=35&tsc=ImageBasicHover&datsrc=I&layout=RowBased&mmasync=1" width="100%" height="800px"></iframe>
-->


</body>



<script>

    // $(document).ready(function(){
    //     init();

        function init() {
            /** while (true) {
                initWord(function(data){
                    // console.log(data);
                    // console.log(data.length);
                    var i;
                    for ( i = 0; i < data.length; i++) {
                        // data[i];
                        // console.log(data[i]);
                    }

                    return data;
                });
            } **/

            for (var i=0;i<2;i++) {
                var data;
                $.ajax({
                    type: "GET",
                    url: "http://localhost:8888/core/word/getBatch",
                    data: {},
                    dataType: "JSON",
                    async: false,
                    success: function(result) {
                        // var data = [];
                        data = result.data;

                    }
                });
                // for (var j = 0; j<data.length; j++){
                //     console.log(data[j]);
                    bbf(data.term);
                    // 延时
                    /*var date = new Date().getTime();
                    var date2 = new Date().getTime();
                    while ((date2-date)<3000){
                        date2 = new Date().getTime();
                    }*/

                    /*setInterval(function(){
                        console.log(data[j]);
                    }, 2000);*/
                // }
            }
        }

        function initWord (cb) {
            var data = [];
            $.get("http://localhost:8888/core/word/getBatch", function(result){
                // $("#word").html(result);

                cb(result.data);
                // 循环data取出单词
                // 每5秒切换一次
                // 循环完所有后再发一次请求
            });

            $.ajax({
                type: "GET",
                url: "http://localhost:8888/core/word/getBatch",
                data: {},
                dataType: "JSON",
                async: false,
                success: function(result) {
                    data = result.data;
                    console.log(result.data);
                }
            });
        }
    // });


    function bf(){
        var audio = document.getElementById('audio');
        if (audio !== null) {
            //检测播放是否已暂停.audio.paused 在播放器播放时返回false.
            if (audio.paused) {
                audio.play();//audio.play();// 这个就是播放
            } else {
                audio.pause();// 这个就是暂停
            }
        }
    }

    function bbf(term){
        // var audio = document.getElementById('idSign');
        // audio.src = "https://cn.bing.com/images/async?q=banana&first=43&count=35&relp=35&tsc=ImageBasicHover&datsrc=I&layout=RowBased&mmasync=1";


        //http://localhost:8888/music/actor.mp3

        var audio = document.getElementById('audio');
        audio.pause();
        audio.src = "http://localhost:8888/music/" + term + ".mp3";
        audio.play();
    }
    function getWord(bbf) {
        $.ajax({
            type: "GET",
            url: "http://localhost:8888/core/word/getBatch",
            data: {},
            dataType: "JSON",
            async: false,
            success: function(result) {
                bbf(result.data);
            }
        });
    }

    var interval = setInterval("init()","3000");
</script>
</html>
